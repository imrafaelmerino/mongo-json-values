language: java
install: mvn install
before_install:
- openssl aes-256-cbc -K $encrypted_b9997e150274_key -iv $encrypted_b9997e150274_iv -in key.asc.enc -out key.asc -d
- echo $PGP_PASSPHRASE | gpg --passphrase-fd 0 --batch --yes --import key.asc

deploy:
- provider: script
  script: mvn deploy --settings .travis/settings.xml -DskipTests=true -B -U -Prelease
  skip_cleanup: true
  on:
    repo: imrafaelmerino/mongo-values
    tags: true
- provider: releases
  skip_cleanup: true
  api_key: "$GITHUB_TOKEN"
  draft: false
  prerelease: false
  body: 'Generated by TravisCI during the release process: build URL: $TRAVIS_BUILD_WEB_URL,
    build number: $TRAVIS_BUILD_NUMBER, commit: $TRAVIS_COMMIT, tag: $TRAVIS_TAG'
  name: Astro
  file:
  - target/JAVADOC.zip
  - docs/CHANGELOG.md
  - docs/README.md
  - target/SOURCES.zip
  on:
    repo: imrafaelmerino/mongo-values
    tags: true

script:
- mvn clean install
